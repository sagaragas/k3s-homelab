---
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: homepage
spec:
  interval: 30m
  chart:
    spec:
      chart: homepage
      version: 2.1.0
      sourceRef:
        kind: HelmRepository
        name: jameswynn
  values:
    image:
      repository: ghcr.io/gethomepage/homepage
      tag: v1.8.0

    enableRbac: true

    serviceAccount:
      create: true
      name: homepage

    env:
      HOMEPAGE_ALLOWED_HOSTS: "home.ragas.cc,homepage.default.svc.cluster.local"

    envFrom:
      - secretRef:
          name: homepage-config

    service:
      main:
        ports:
          http:
            port: 3000

    ingress:
      main:
        enabled: false

    config:
      bookmarks:
        - Developer:
            - Github:
                - abbr: GH
                  href: https://github.com/
        - Social:
            - Reddit:
                - abbr: RE
                  href: https://reddit.com/
        - Entertainment:
            - YouTube:
                - abbr: YT
                  href: https://youtube.com/

      services:
        - Hypervisor:
            - Server-1:
                icon: proxmox.svg
                href: https://172.16.1.2:8006
                description: pve1
                ping: 172.16.1.2
                widget:
                  type: proxmox
                  url: https://172.16.1.2:8006
                  username: "{{HOMEPAGE_VAR_PROXMOX_USER}}"
                  password: "{{HOMEPAGE_VAR_PROXMOX_PASS}}"
                  node: pve1
            - Server-2:
                icon: proxmox.svg
                href: https://172.16.1.3:8006
                description: pve2
                ping: 172.16.1.3
                widget:
                  type: proxmox
                  url: https://172.16.1.3:8006
                  username: "{{HOMEPAGE_VAR_PROXMOX_USER}}"
                  password: "{{HOMEPAGE_VAR_PROXMOX_PASS}}"
                  node: pve2
            - Server-3:
                icon: proxmox.svg
                href: https://172.16.1.4:8006
                description: pve3
                ping: 172.16.1.4
                widget:
                  type: proxmox
                  url: https://172.16.1.4:8006
                  username: "{{HOMEPAGE_VAR_PROXMOX_USER}}"
                  password: "{{HOMEPAGE_VAR_PROXMOX_PASS}}"
                  node: pve3
            - Server-4:
                icon: proxmox.svg
                href: https://172.16.1.5:8006
                description: pve4
                ping: 172.16.1.5
                widget:
                  type: proxmox
                  url: https://172.16.1.5:8006
                  username: "{{HOMEPAGE_VAR_PROXMOX_USER}}"
                  password: "{{HOMEPAGE_VAR_PROXMOX_PASS}}"
                  node: pve4

        - Storage:
            - Volume-1:
                icon: https://cdn.jsdelivr.net/gh/selfhst/icons/svg/synology-light.svg
                href: https://172.16.1.250:5001/
                description: Backup
                ping: 172.16.1.250
                widget:
                  type: diskstation
                  url: https://172.16.1.250:5001/
                  username: "{{HOMEPAGE_VAR_NAS_USER}}"
                  password: "{{HOMEPAGE_VAR_NAS_PASS}}"
                  volume: volume_1
            - Volume-2:
                icon: https://cdn.jsdelivr.net/gh/selfhst/icons/svg/synology-light.svg
                href: https://172.16.1.250:5001/
                description: Media
                ping: 172.16.1.250
                widget:
                  type: diskstation
                  url: https://172.16.1.250:5001/
                  username: "{{HOMEPAGE_VAR_NAS_USER}}"
                  password: "{{HOMEPAGE_VAR_NAS_PASS}}"
                  volume: volume_2
            - PBS:
                icon: proxmox.svg
                href: https://172.16.1.12:8007/
                description: Proxmox Backup
                ping: 172.16.1.12
                widget:
                  type: proxmoxbackupserver
                  url: https://172.16.1.12:8007
                  username: "{{HOMEPAGE_VAR_PBS_USER}}"
                  password: "{{HOMEPAGE_VAR_PBS_PASS}}"

        - Media:
            - Plex:
                icon: plex.svg
                href: https://plex.ragas.sh
                description: Media Server
                ping: 172.16.1.33
                widget:
                  type: plex
                  url: https://plex.ragas.sh
                  key: "{{HOMEPAGE_VAR_PLEX_KEY}}"
            - Jellyfin:
                icon: jellyfin.svg
                href: http://172.16.1.30:8096
                description: Jellyfin
                ping: 172.16.1.30
                widget:
                  type: jellyfin
                  url: http://172.16.1.30:8096
                  key: "{{HOMEPAGE_VAR_JELLYFIN_KEY}}"
                  enableBlocks: true
                  enableNowPlaying: true
                  enableUser: true
            - Tautulli:
                icon: tautulli.svg
                href: http://172.16.1.33:8181
                description: Plex stats
                ping: 172.16.1.33
                widget:
                  type: tautulli
                  url: http://172.16.1.33:8181
                  key: "{{HOMEPAGE_VAR_TAUTULLI_KEY}}"

        - Requests:
            - Overseerr:
                icon: overseerr.svg
                href: https://request.ragas.sh
                description: Plex Requests
                ping: 172.16.1.31
                widget:
                  type: overseerr
                  url: http://172.16.1.31:5055
                  key: "{{HOMEPAGE_VAR_OVERSEERR_KEY}}"
            - Jellyseerr:
                icon: jellyseerr.svg
                href: http://172.16.1.31:5056
                description: Jelly Requests
                ping: 172.16.1.31
                widget:
                  type: jellyseerr
                  url: http://172.16.1.31:5056
                  key: "{{HOMEPAGE_VAR_JELLYSEERR_KEY}}"

        - Media Management:
            - Sonarr:
                icon: sonarr.svg
                href: http://172.16.1.31:8989
                description: TV Shows
                ping: 172.16.1.31
                widget:
                  type: sonarr
                  url: http://172.16.1.31:8989
                  key: "{{HOMEPAGE_VAR_SONARR_KEY}}"
            - Radarr:
                icon: radarr.svg
                href: http://172.16.1.31:7878
                description: Movies
                ping: 172.16.1.31
                widget:
                  type: radarr
                  url: http://172.16.1.31:7878
                  key: "{{HOMEPAGE_VAR_RADARR_KEY}}"
            - Prowlarr:
                icon: prowlarr.svg
                href: http://172.16.1.31:9696
                description: Indexers
                ping: 172.16.1.31
                widget:
                  type: prowlarr
                  url: http://172.16.1.31:9696
                  key: "{{HOMEPAGE_VAR_PROWLARR_KEY}}"
        - Network:
            - OpnSense:
                icon: opnsense.svg
                href: http://172.16.1.1/
                description: Firewall
                ping: 172.16.1.1
                widget:
                  type: opnsense
                  url: https://172.16.1.1/
                  username: "{{HOMEPAGE_VAR_OPNSENSE_USER}}"
                  password: "{{HOMEPAGE_VAR_OPNSENSE_PASS}}"
            - Adguard:
                icon: https://cdn.jsdelivr.net/gh/selfhst/icons/svg/adguard-home.svg
                href: https://172.16.1.11
                description: Adblocker
                ping: 172.16.1.11
                widget:
                  type: adguard
                  url: https://172.16.1.11
                  username: "{{HOMEPAGE_VAR_ADGUARD_USER}}"
                  password: "{{HOMEPAGE_VAR_ADGUARD_PASS}}"
            - qBittorrent:
                icon: qbittorrent.svg
                href: http://172.16.1.32:8080
                description: Downloads
                ping: 172.16.1.32
                widget:
                  type: qbittorrent
                  url: http://172.16.1.32:8080
                  username: "{{HOMEPAGE_VAR_QBIT_USER}}"
                  password: "{{HOMEPAGE_VAR_QBIT_PASS}}"
            - Cloudflare:
                icon: cloudflare.svg
                href: https://one.dash.cloudflare.com
                description: Tunnel
                widget:
                  type: cloudflared
                  accountid: "{{HOMEPAGE_VAR_CF_ACCOUNT}}"
                  tunnelid: "{{HOMEPAGE_VAR_CF_TUNNEL}}"
                  key: "{{HOMEPAGE_VAR_CF_KEY}}"
            - Uptime-Kuma:
                icon: uptime-kuma.svg
                href: http://172.16.1.249:3001
                description: Monitoring
                ping: 172.16.1.249
                widget:
                  type: uptimekuma
                  url: http://172.16.1.249:3001
                  slug: 1
            - Unifi:
                icon: unifi.svg
                href: https://172.16.1.253:8443
                description: Network
                ping: 172.16.1.253
                widget:
                  type: unifi
                  url: https://172.16.1.253:8443
                  site: home
                  username: "{{HOMEPAGE_VAR_UNIFI_USER}}"
                  password: "{{HOMEPAGE_VAR_UNIFI_PASS}}"

      widgets:
        - search:
            provider: google
            target: _blank
        - datetime:
            text_size: xl
            format:
              timeStyle: short
              dateStyle: long
        - kubernetes:
            cluster:
              show: true
              cpu: true
              memory: true
              showLabel: true
              label: "Talos Cluster"
            nodes:
              show: true
              cpu: true
              memory: true
              showLabel: true

      settings:
        title: "Sagar's Homelab"
        favicon: https://raw.githubusercontent.com/walkxcode/dashboard-icons/main/png/heimdall.png
        background:
          image: https://images.unsplash.com/photo-1579546929518-9e396f3cc809?w=1920&q=80
          blur: sm
          saturate: 100
          brightness: 50
          opacity: 80
        theme: dark
        color: cyan
        disableCollapse: true
        useEqualHeights: true
        headerStyle: clean
        hideVersion: true
        showStats: true
        statusStyle: dot
        hideErrors: false
        cardBlur: md
        layout:
          - Hypervisor:
              header: true
              style: row
              columns: 4
              icon: proxmox.svg
          - Storage:
              header: true
              style: row
              columns: 3
              icon: https://cdn.jsdelivr.net/gh/selfhst/icons/svg/synology-light.svg
          - Media:
              header: true
              style: row
              columns: 3
              icon: plex.svg
          - Requests:
              header: true
              style: row
              columns: 2
              icon: overseerr.svg
          - Media Management:
              header: true
              style: row
              columns: 3
              icon: sonarr.svg
          - Network:
              header: true
              style: row
              columns: 6
              icon: ubiquiti.svg

      customCss:
        - |
          :root {
            --color-cyan: #00f0ff;
            --color-magenta: #ff00ff;
            --color-yellow: #fcee0a;
          }
          body {
            font-family: 'Share Tech Mono', 'Courier New', monospace;
          }
          #page_container {
            background: linear-gradient(135deg, rgba(0,0,0,0.9) 0%, rgba(20,20,40,0.95) 100%);
          }
          .service-card {
            border: 1px solid rgba(0, 240, 255, 0.3) !important;
            background: rgba(0, 20, 40, 0.7) !important;
            box-shadow: 0 0 15px rgba(0, 240, 255, 0.2), inset 0 0 20px rgba(0, 240, 255, 0.05) !important;
            transition: all 0.3s ease !important;
          }
          .service-card:hover {
            border-color: rgba(0, 240, 255, 0.8) !important;
            box-shadow: 0 0 30px rgba(0, 240, 255, 0.5), inset 0 0 30px rgba(0, 240, 255, 0.1) !important;
            transform: translateY(-2px) !important;
          }
          .widget {
            border: 1px solid rgba(255, 0, 255, 0.2) !important;
            background: rgba(20, 0, 30, 0.6) !important;
          }
          h1, h2, .text-theme-700 {
            color: #00f0ff !important;
            text-shadow: 0 0 10px rgba(0, 240, 255, 0.5) !important;
          }
          .status-dot {
            box-shadow: 0 0 8px currentColor !important;
          }
          .information-widget-search input {
            background: rgba(0, 20, 40, 0.8) !important;
            border: 1px solid rgba(0, 240, 255, 0.5) !important;
            color: #00f0ff !important;
          }
          .bookmark-icon {
            filter: drop-shadow(0 0 3px rgba(0, 240, 255, 0.5));
          }
